const data = [
    {
        id: 1,
        name: "Cà phê sữa",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/ca-phe-sua-da_400x400.jpg",
        imgUrl2: "images/coffee/cafesuanong.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    },
    {
        id: 2,
        name: "Cà phê sữa nóng",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/cafesuanong.jpg",
        imgUrl2: "images/coffee/caphesuada2.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    },
    {
        id: 3,
        name: "Bạc sỉu",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/bacsiu.jpg",
        imgUrl2: "images/coffee/caphesuada2.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    },
    {
        id: 4,
        name: "Bạc sỉu",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/bacsiu.jpg",
        imgUrl2: "images/coffee/caphesuada2.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    },
    {
        id: 5,
        name: "Bạc sỉu",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/bacsiu.jpg",
        imgUrl2: "images/coffee/caphesuada2.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    },
    {
        id: 6,
        name: "Bạc sỉu",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/bacsiu.jpg",
        imgUrl2: "images/coffee/caphesuada2.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    },
    {
        id: 7,
        name: "Bạc sỉu",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/bacsiu.jpg",
        imgUrl2: "images/coffee/caphesuada2.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    }, {
        id: 8,
        name: "Bạc sỉu",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/bacsiu.jpg",
        imgUrl2: "images/coffee/caphesuada2.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    },
    {
        id: 9,
        name: "Bạc sỉu",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/bacsiu.jpg",
        imgUrl2: "images/coffee/caphesuada2.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    },
    {
        id: 10,
        name: "Bạc sỉu",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/bacsiu.jpg",
        imgUrl2: "images/coffee/caphesuada2.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    },
    {
        id: 11,
        name: "Bạc sỉu",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/bacsiu.jpg",
        imgUrl2: "images/coffee/caphesuada2.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    },
    {
        id: 12,
        name: "Bạc sỉu",
        price: 40,
        description: 'Cà Phê Đắk Lắk Nguyên Chất Được Pha Phin Truyền Thống Kết Hợp Với Sữa Đặc Tạo Nên Hương Vị Đậm Đà, Hài Hòa Giữa Vị Ngọt Đầu Lưỡi Và Vị Đắng Thanh Thoát Nơi Hậu Vị.',
        imgUrl: "images/coffee/bacsiu.jpg",
        imgUrl2: "images/coffee/caphesuada2.jpg",
        sizes: [
            {
                id: 1,
                size: 'S',
                price: 40
            },
            {
                id: 2,
                size: 'M',
                price: 45
            },
            {
                id: 3,
                size: 'L',
                price: 50
            }
        ]
    },
]
let cart = [];
function getItemLocal() {
    let storage = localStorage.getItem("orderFood");
    if (storage) {
        cart = JSON.parse(storage)
    }
    return cart;
}
const popupEL = document.querySelector('.popup-login');
const notify = document.querySelector('.notify');
const message = notify.querySelector('.message')
const btnLogin = document.querySelector('.show-login');
const cartList = document.getElementById('cart-modal');
const textEmpty = cartList.querySelector('.empty-cart');
const btnClose = document.querySelector('.close-btn');
const btnSignIn = popupEL.querySelector('.button-login')
const ipEmail = document.querySelector('input[name="email"]');
const ipPassword = document.querySelector('input[name="password"]');
const accountEl = document.querySelector('.list-account');

let ipEmailV = ipEmail.value;
let ipPasswordV = ipPassword.value;

let d;
btnLogin.addEventListener('click', function () {
    document.querySelector('.modal-loginJS').classList.add("appear");

})

btnClose.addEventListener('click', function () {
    document.querySelector('.modal-loginJS').classList.remove("appear");

})
function validInput() {
    if (ipEmailV.length > 1 && ipPasswordV.length > 1) {
        btnSignIn.classList.add('btn-login');
    } else {
        btnSignIn.classList.remove('btn-login');
    }
}
btnSignIn.addEventListener('click', function () {
    if (ipEmail.value === 'Admin' && ipPassword.value === '123') {
        message.textContent = 'Login successfully!';
        notify.classList.remove('hidden');
        let loginEl = accountEl.querySelector('.text-login');
        loginEl.textContent = "Đăng xuất"
        popupEL.classList.add('hidden')
        document.querySelector('.popup-login').classList.remove("active");
        setTimeout(hideEl, 5000);
    } else {
        message.textContent = 'Sai tài khoản hoặc mật khẩu!';
        notify.classList.remove('hidden');
        setTimeout(hideEl, 5000);
    }
})

function hideEl() {
    notify.classList.add('hidden');
}

function addToCartPage(item) {
    getItemLocal();

}


function increaseValue(a, b) {
    let input = b.previousElementSibling;
    let value = parseInt(input.value, 10);
    value = isNaN(value) ? 0 : value;
    value++;
    input.value = value;
}
function decreaseValue(a, b) {
    let input = b.nextElementSibling;
    var value = parseInt(input.value, 10);
    if (value > 1) {
        value = isNaN(value) ? 0 : value;
        value--;
        input.value = value;
    }
}
function addToCart(item) {
    let storage = localStorage.getItem("orderFood");
    if (storage) {
        cart = JSON.parse(storage)
    }

    let valueSize;

    let radioEl = document.getElementsByName('sizeRadio');
    for (let i = 0; i < radioEl.length; i += 1) {
        if (radioEl[i].checked) {
            valueSize = radioEl[i].value;
            break;
        }
    }

    let a;
    let resultt;
    data.forEach(function (item) {
        a = item.sizes;
    })
    a.forEach(function (items) {
        if (valueSize === items.size) {
            resultt = items.price;

        } else {
            return;
        }

    })
    console.log(resultt);
    console.log(valueSize);
    let ipQuantity = document.getElementById("ipQuantity").value;
    let result = Number(ipQuantity);



    textEmpty.classList.add('hidden');

    const target = cart.find(element => element.id === item.id);
    let arraySizes = false;
    let test;
    cart.forEach(function (itemsss) {
        if (item.id === itemsss.id) {

            if (valueSize === itemsss.size) {
                arraySizes = true;
                console.log(true);
            } else {
                arraySizes;
                console.log(false);
            }
        } else {
            return;
        }
    })
    if (target) {

        // console.log(arraySizes);
        // console.log(valueSize);
        // target.quantity += result;
        // // target.prices = resultt;
        // const divEl = cartList.querySelector(`div[data-id='${target.id}']`);
        // // const quantiyEl = divEl.querySelector('.cart-item_quantity');
        // // quantiyEl.textContent = `x ${target.quantity}`;
        // // notifyEl.classList.remove('hidden');
        // // textNotify.textContent = "Sản phẩm đã tồn tại";
        // // setTimeout(hideEl, 5000);
        // // localStorage.setItem("orderFood", JSON.stringify(cart));
        if (arraySizes === true) {
            console.log(valueSize);

            console.log(true);
            target.quantity += result;
            localStorage.setItem("orderFood", JSON.stringify(cart));
            updateQuantity();

        }
        else {
            console.log(valueSize);

            const products = {
                ...item,
                quantity: result,
                size: valueSize,
                prices: resultt
            }
            cart.push(products);
            localStorage.setItem("orderFood", JSON.stringify(cart));
            updateQuantity();
        }

    } else {

        const products = {
            ...item,
            quantity: result,
            size: valueSize,
            prices: resultt
        }
        cart.push(products);
        localStorage.setItem("orderFood", JSON.stringify(cart));

        updateQuantity();

        //     console.log(cart);
        //     const divEl = document.createElement('div');
        //     divEl.setAttribute('data-id', products.id);
        //     divEl.classList.add('.cart-item');
        //     cartList.appendChild(divEl)

        //     divEl.innerHTML = `<div class="cart-item">
        //     <div class="cart-item__img">
        //         <img src="${products.imgUrl}">
        //     </div>
        //     <div class="detail-product__cart">
        //         <strong>${products.name}</strong>
        //         <p>${products.price.toFixed(2)}<span class="cart-item_quantity"> x${products.quantity}</span></p>
        //     </div>
        // </div>`

    }

}
function updateQuantity() {
    const cartQuantity = document.querySelector('.cart-quantity');
    let totalQuantity = 0;
    getItemLocal();
    for (let i = 0; i < cart.length; i++) {
        totalQuantity = totalQuantity + cart[i].quantity;


    }
    cartQuantity.textContent = totalQuantity;
    console.log(totalQuantity);
}
validInput();